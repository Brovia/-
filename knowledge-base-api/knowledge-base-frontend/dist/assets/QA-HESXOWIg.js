import{r as k,l as U,c as N,h as E,z as m,A as d,B as e,R as a,J as o,al as r,L as x,Q as b,a5 as V,W as K,ah as W,O as B,P as c,E as G,I as P,u as I}from"./vendor-CBsB69ib.js";import{l as T,t as H,c as J}from"./element-CPMJgIwH.js";import{k as O}from"./api-BTqAopYE.js";import{_ as $}from"./index-DuDiLGTc.js";import"./axios-ngrFHoWO.js";const j={class:"qa-page"},X={class:"card"},Y={class:"chat-container"},Z={class:"message-avatar"},ee={class:"message-content"},te={class:"message-text"},se={key:0,class:"message-meta"},ae={class:"confidence"},oe={key:0,class:"sources"},ne={class:"source-document"},le={class:"source-excerpt"},ie={class:"source-relevance"},de={key:0,class:"message-item ai-message"},ue={class:"message-avatar"},re={class:"input-area"},ce={class:"card"},me={class:"card"},_e={class:"quick-questions"},pe={class:"card"},ve={class:"qa-stats"},fe={class:"stat-item"},ge={class:"stat-value"},he={class:"stat-item"},ye={class:"stat-value"},we={class:"stat-item"},ke={class:"stat-value"},xe={__name:"QA",setup(be){const p=k(""),v=k(!1),_=k([]),u=U({context_limit:3,temperature:.7,include_sources:!0}),z=["什么是负载均衡？","腾讯云CLB和阿里云ALB有什么区别？","如何配置私有网络？","弹性IP和公网IP有什么区别？","NAT网关的主要作用是什么？","专线和云联网有什么区别？","VPN连接如何配置？"],D=N(()=>{const n=_.value.filter(l=>{var i;return l.type==="ai"&&((i=l.metadata)==null?void 0:i.confidence)});return n.length===0?0:(n.reduce((l,i)=>l+i.metadata.confidence,0)/n.length*100).toFixed(1)}),F=N(()=>{const n=_.value.filter(l=>{var i;return l.type==="ai"&&((i=l.metadata)==null?void 0:i.processing_time)});return n.length===0?0:(n.reduce((l,i)=>l+i.metadata.processing_time,0)/n.length).toFixed(2)}),h=async()=>{if(!p.value.trim()){T.warning("请输入问题");return}const n=p.value.trim();try{_.value.push({type:"user",content:n,timestamp:new Date}),p.value="",v.value=!0;const t=await O.askQuestion({question:n,context_limit:u.context_limit,include_sources:u.include_sources,temperature:u.temperature});_.value.push({type:"ai",content:t.data.answer,metadata:{confidence:t.data.confidence,processing_time:t.data.processing_time,sources:t.data.sources},timestamp:new Date})}catch(t){T.error("问答失败，请稍后重试"),console.error("QA error:",t),_.value.push({type:"ai",content:"抱歉，我暂时无法回答您的问题，请稍后重试。",metadata:{confidence:0,processing_time:0,sources:[]},timestamp:new Date})}finally{v.value=!1}},M=n=>{p.value=n};return E(()=>{_.value.push({type:"ai",content:"您好！我是云厂商网络产品知识库智能助手，可以回答关于腾讯云、阿里云、火山云、华为云、AWS、Azure、GCP等云厂商的网络产品问题，包括负载均衡、私有网络、弹性IP、NAT网关、专线、云联网、VPN等。请随时提问！",metadata:{confidence:1,processing_time:0,sources:[]},timestamp:new Date})}),(n,t)=>{const l=r("el-icon"),i=r("Robot"),S=r("el-input"),f=r("el-col"),C=r("el-button"),A=r("el-row"),Q=r("el-form"),q=r("el-slider"),y=r("el-form-item"),L=r("el-switch");return d(),m("div",j,[t[14]||(t[14]=e("div",{class:"page-header"},[e("h2",null,"智能问答"),e("p",null,"基于知识库的智能问答系统")],-1)),a(A,{gutter:20},{default:o(()=>[a(f,{span:16},{default:o(()=>[e("div",X,[t[7]||(t[7]=e("h3",null,"问答对话",-1)),e("div",Y,[(d(!0),m(b,null,V(_.value,(s,w)=>(d(),m("div",{key:w,class:G(["message-item",{"user-message":s.type==="user","ai-message":s.type==="ai"}])},[e("div",Z,[s.type==="user"?(d(),P(l,{key:0},{default:o(()=>[a(I(H))]),_:1})):(d(),P(l,{key:1},{default:o(()=>[a(I(J))]),_:1}))]),e("div",ee,[e("div",te,c(s.content),1),s.type==="ai"&&s.metadata?(d(),m("div",se,[e("div",ae,[e("span",null,"置信度: "+c((s.metadata.confidence*100).toFixed(1))+"%",1),e("span",null,"处理时间: "+c(s.metadata.processing_time)+"s",1)]),s.metadata.sources&&s.metadata.sources.length>0?(d(),m("div",oe,[t[4]||(t[4]=e("div",{class:"sources-title"},"参考来源:",-1)),(d(!0),m(b,null,V(s.metadata.sources,(g,R)=>(d(),m("div",{key:R,class:"source-item"},[e("div",ne,c(g.document),1),e("div",le,c(g.excerpt),1),e("div",ie,"相关性: "+c((g.relevance*100).toFixed(1))+"%",1)]))),128))])):x("",!0)])):x("",!0)])],2))),128)),v.value?(d(),m("div",de,[e("div",ue,[a(l,null,{default:o(()=>[a(i)]),_:1})]),t[5]||(t[5]=e("div",{class:"message-content"},[e("div",{class:"typing-indicator"},[e("span"),e("span"),e("span")])],-1))])):x("",!0)]),e("div",re,[a(Q,{onSubmit:K(h,["prevent"])},{default:o(()=>[a(A,{gutter:10},{default:o(()=>[a(f,{span:18},{default:o(()=>[a(S,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),placeholder:"请输入您的问题...",onKeyup:W(h,["enter"]),disabled:v.value,type:"textarea",rows:2,resize:"none"},null,8,["modelValue","disabled"])]),_:1}),a(f,{span:6},{default:o(()=>[a(C,{type:"primary",onClick:h,loading:v.value,disabled:!p.value.trim(),style:{width:"100%",height:"100%"}},{default:o(()=>[...t[6]||(t[6]=[B(" 提问 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])])]),_:1}),a(f,{span:8},{default:o(()=>[e("div",ce,[t[8]||(t[8]=e("h3",null,"问答设置",-1)),a(Q,{model:u,"label-width":"80px"},{default:o(()=>[a(y,{label:"上下文数量"},{default:o(()=>[a(q,{modelValue:u.context_limit,"onUpdate:modelValue":t[1]||(t[1]=s=>u.context_limit=s),min:1,max:10,step:1,"show-input":"","show-input-controls":!1},null,8,["modelValue"])]),_:1}),a(y,{label:"回答随机性"},{default:o(()=>[a(q,{modelValue:u.temperature,"onUpdate:modelValue":t[2]||(t[2]=s=>u.temperature=s),min:0,max:2,step:.1,"show-input":"","show-input-controls":!1},null,8,["modelValue"])]),_:1}),a(y,{label:"显示来源"},{default:o(()=>[a(L,{modelValue:u.include_sources,"onUpdate:modelValue":t[3]||(t[3]=s=>u.include_sources=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),e("div",me,[t[9]||(t[9]=e("h3",null,"常见问题",-1)),e("div",_e,[(d(),m(b,null,V(z,(s,w)=>a(C,{key:w,size:"small",onClick:g=>M(s),disabled:v.value},{default:o(()=>[B(c(s),1)]),_:2},1032,["onClick","disabled"])),64))])]),e("div",pe,[t[13]||(t[13]=e("h3",null,"问答统计",-1)),e("div",ve,[e("div",fe,[t[10]||(t[10]=e("span",{class:"stat-label"},"总提问数:",-1)),e("span",ge,c(_.value.filter(s=>s.type==="user").length),1)]),e("div",he,[t[11]||(t[11]=e("span",{class:"stat-label"},"平均置信度:",-1)),e("span",ye,c(D.value)+"%",1)]),e("div",we,[t[12]||(t[12]=e("span",{class:"stat-label"},"平均响应时间:",-1)),e("span",ke,c(F.value)+"s",1)])])])]),_:1})]),_:1})])}}},Ne=$(xe,[["__scopeId","data-v-1c4e9b3f"]]);export{Ne as default};
