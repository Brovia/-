import{r as V,l as K,h as O,z as d,A as i,B as s,L as k,R as e,J as t,al as r,ah as j,u as N,O as m,W as J,P as c,Q as U,a5 as B,I as L}from"./vendor-CBsB69ib.js";import{s as T,l as v,d as Q}from"./element-CPMJgIwH.js";import{k as X}from"./api-BTqAopYE.js";import{_ as Y}from"./index-DuDiLGTc.js";import"./axios-ngrFHoWO.js";const Z={class:"search-page"},ee={class:"card"},le={key:0,class:"search-results"},te={class:"results-header"},ae={class:"results-info"},oe=["onClick"],se={class:"result-title"},ne={class:"result-content"},re={class:"result-meta"},ie={class:"meta-left"},ue={class:"meta-right"},de={class:"result-score"},ce={key:0,class:"result-highlight"},_e=["innerHTML"],me={key:1,class:"empty-state"},pe={key:2,class:"search-tips"},ve={__name:"Search",setup(fe){const g=V(!1),y=V(!1),f=V([]),b=V({total:0,processing_time:0}),a=K({query:"",limit:10,provider:"",category:"",min_score:0}),S=async()=>{if(!a.query.trim()){v.warning("请输入搜索关键词");return}try{g.value=!0,y.value=!0;const u=new URLSearchParams({query:a.query.trim(),limit:a.limit.toString(),min_score:a.min_score.toString()});a.provider&&u.append("provider",a.provider),a.category&&u.append("category",a.category);const l=await X.search(Object.fromEntries(u));if(l&&l.status===200){const _=l.data||{};f.value=_.results||[],b.value={total:_.total||0,processing_time:_.processing_time||0},f.value.length===0?v.info("未找到相关结果，请尝试其他关键词"):v.success(`找到 ${_.total} 条相关结果`)}else v.error("搜索失败: 未知错误")}catch(u){v.error("搜索失败，请稍后重试"),console.error("Search error:",u)}finally{g.value=!1}},P=()=>{a.query="",a.limit=10,a.provider="",a.category="",a.min_score=0,f.value=[],y.value=!1,b.value={total:0,processing_time:0}},F=u=>{v.info(`查看文档: ${u.title}`)},I=u=>`${(u*100).toFixed(0)}%`;return O(()=>{}),(u,l)=>{const _=r("el-icon"),$=r("el-input"),p=r("el-form-item"),h=r("el-col"),n=r("el-option"),w=r("el-select"),q=r("el-row"),E=r("el-slider"),C=r("el-button"),R=r("el-form"),x=r("el-tag"),W=r("el-empty"),D=r("el-alert");return i(),d("div",Z,[l[11]||(l[11]=s("div",{class:"page-header"},[s("h2",null,"知识搜索"),s("p",null,"在知识库中搜索相关文档和内容")],-1)),s("div",ee,[e(R,{model:a,onSubmit:J(S,["prevent"])},{default:t(()=>[e(q,{gutter:20},{default:t(()=>[e(h,{span:16},{default:t(()=>[e(p,{label:"搜索内容"},{default:t(()=>[e($,{modelValue:a.query,"onUpdate:modelValue":l[0]||(l[0]=o=>a.query=o),placeholder:"请输入搜索关键词...",onKeyup:j(S,["enter"]),clearable:""},{prefix:t(()=>[e(_,null,{default:t(()=>[e(N(T))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(p,{label:"结果数量"},{default:t(()=>[e(w,{modelValue:a.limit,"onUpdate:modelValue":l[1]||(l[1]=o=>a.limit=o),placeholder:"选择结果数量"},{default:t(()=>[e(n,{label:"10条",value:10}),e(n,{label:"20条",value:20}),e(n,{label:"50条",value:50})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(q,{gutter:20},{default:t(()=>[e(h,{span:8},{default:t(()=>[e(p,{label:"云服务商"},{default:t(()=>[e(w,{modelValue:a.provider,"onUpdate:modelValue":l[2]||(l[2]=o=>a.provider=o),placeholder:"选择云服务商",clearable:""},{default:t(()=>[e(n,{label:"腾讯云",value:"腾讯云"}),e(n,{label:"阿里云",value:"阿里云"}),e(n,{label:"火山云",value:"火山云"}),e(n,{label:"华为云",value:"华为云"}),e(n,{label:"AWS",value:"AWS"}),e(n,{label:"Azure",value:"Azure"}),e(n,{label:"GCP",value:"GCP"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(p,{label:"产品分类"},{default:t(()=>[e(w,{modelValue:a.category,"onUpdate:modelValue":l[3]||(l[3]=o=>a.category=o),placeholder:"选择产品分类",clearable:""},{default:t(()=>[e(n,{label:"负载均衡",value:"负载均衡"}),e(n,{label:"私有网络",value:"私有网络"}),e(n,{label:"弹性IP",value:"弹性IP"}),e(n,{label:"NAT网关",value:"NAT网关"}),e(n,{label:"专线",value:"专线"}),e(n,{label:"云联网",value:"云联网"}),e(n,{label:"VPN",value:"VPN"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:t(()=>[e(p,{label:"最小相似度"},{default:t(()=>[e(E,{modelValue:a.min_score,"onUpdate:modelValue":l[4]||(l[4]=o=>a.min_score=o),min:0,max:1,step:.1,"format-tooltip":I,"show-input":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(C,{type:"primary",onClick:S,loading:g.value,icon:N(T)},{default:t(()=>[...l[5]||(l[5]=[m(" 搜索 ",-1)])]),_:1},8,["loading","icon"]),e(C,{onClick:P},{default:t(()=>[...l[6]||(l[6]=[m("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),f.value.length>0?(i(),d("div",le,[s("div",te,[l[7]||(l[7]=s("h3",null,"搜索结果",-1)),s("div",ae,[s("span",null,"找到 "+c(b.value.total)+" 条结果",1),s("span",null,"耗时 "+c(b.value.processing_time)+"s",1)])]),(i(!0),d(U,null,B(f.value,(o,G)=>{var A,z;return i(),d("div",{key:G,class:"search-result",onClick:M=>F(o)},[s("div",se,[e(_,null,{default:t(()=>[e(N(Q))]),_:1}),m(" "+c(o.title),1)]),s("div",ne,c(o.content),1),s("div",re,[s("div",ie,[e(x,{size:"small",type:"info"},{default:t(()=>[m(c(o.source),1)]),_:2},1024),(A=o.metadata)!=null&&A.provider?(i(),L(x,{key:0,size:"small",type:"success"},{default:t(()=>[m(c(o.metadata.provider),1)]),_:2},1024)):k("",!0),(z=o.metadata)!=null&&z.category?(i(),L(x,{key:1,size:"small",type:"warning"},{default:t(()=>[m(c(o.metadata.category),1)]),_:2},1024)):k("",!0)]),s("div",ue,[s("span",de,"相似度: "+c((o.score*100).toFixed(1))+"%",1)])]),o.highlight&&o.highlight.length>0?(i(),d("div",ce,[l[8]||(l[8]=s("div",{class:"highlight-title"},"相关片段:",-1)),(i(!0),d(U,null,B(o.highlight,(M,H)=>(i(),d("div",{key:H,class:"highlight-fragment",innerHTML:M},null,8,_e))),128))])):k("",!0)],8,oe)}),128))])):!g.value&&y.value?(i(),d("div",me,[e(W,{description:"未找到相关结果"},{default:t(()=>[e(C,{type:"primary",onClick:P},{default:t(()=>[...l[9]||(l[9]=[m("重新搜索",-1)])]),_:1})]),_:1})])):y.value?k("",!0):(i(),d("div",pe,[e(D,{title:"搜索提示",type:"info",closable:!1},{default:t(()=>[...l[10]||(l[10]=[s("ul",null,[s("li",null,"支持中英文关键词搜索"),s("li",null,"使用语义搜索技术，理解查询意图"),s("li",null,"可以通过云服务商和分类进行筛选"),s("li",null,"调整相似度阈值可以控制结果精度")],-1)])]),_:1})]))])}}},ke=Y(ve,[["__scopeId","data-v-5bee2cb3"]]);export{ke as default};
