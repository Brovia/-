import{a as h}from"./axios-ngrFHoWO.js";import{A as E,l as u}from"./element-CPMJgIwH.js";const I={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},d=(e,n="")=>I[e]||n,g={apiBaseUrl:d("VITE_API_BASE_URL","http://localhost:8000"),apiTimeout:parseInt(d("VITE_API_TIMEOUT","30000")),apiVersion:d("VITE_API_VERSION","v1"),enableDebug:d("VITE_ENABLE_DEBUG","true")==="true"},r={knowledge:{search:"/knowledge/search",qa:"/knowledge/qa",summarize:"/knowledge/summarize",recommend:"/knowledge/recommend",stats:"/knowledge/stats"},admin:{health:"/admin/health",metrics:"/admin/metrics",reindex:"/admin/reindex",documents:"/admin/documents",upload:"/admin/documents/upload",deleteDocument:e=>`/admin/documents/${e}`}},p={timeout:g.apiTimeout,headers:{"Content-Type":"application/json"}},l={network:"网络连接失败，请检查网络",timeout:"请求超时，请稍后重试",unauthorized:"认证失败，请检查API密钥",forbidden:"权限不足",notFound:"请求的资源不存在",serverError:"服务器内部错误",unknown:"请求失败"},m=g.enableDebug,k=()=>{const e=h.create({baseURL:`${g.apiBaseUrl}/api/${g.apiVersion}`,timeout:p.timeout,headers:p.headers}),n=async t=>{if(t.response){const{status:o,data:i}=t.response;let a=l.unknown;switch(o){case 401:case 403:return a=o===401?l.unauthorized:l.forbidden,u.error(a),null;case 404:return a=l.notFound,u.error(a),null;case 408:return a=l.timeout,u.error(a),null;case 500:return a=l.serverError,u.error(a),null;default:return a=(i==null?void 0:i.detail)||(i==null?void 0:i.message)||l.unknown,u.error(a),null}}else return t.request?(u.error(l.network),null):(u.error(t.message||l.unknown),null)};return e.interceptors.request.use(t=>{var o;return m&&console.log(`[API Request] ${(o=t.method)==null?void 0:o.toUpperCase()} ${t.url}`,t),t.showLoading!==!1&&(t.loadingInstance=E.service({lock:!0,text:"加载中...",background:"rgba(0, 0, 0, 0.7)"})),t},t=>(m&&console.error("[API Request Error]",t),Promise.reject(t))),e.interceptors.response.use(t=>{var o;return t.config.loadingInstance&&t.config.loadingInstance.close(),m&&console.log(`[API Response] ${(o=t.config.method)==null?void 0:o.toUpperCase()} ${t.config.url}`,t.data),t},async t=>{var i;(i=t.config)!=null&&i.loadingInstance&&t.config.loadingInstance.close(),m&&console.error("[API Response Error]",t);const o=await n(t);return o||Promise.reject(t)}),e},c=k(),s={get:(e,n={})=>c.get(e,n),post:(e,n,t={})=>c.post(e,n,t),put:(e,n,t={})=>c.put(e,n,t),delete:(e,n={})=>c.delete(e,n),patch:(e,n,t={})=>c.patch(e,n,t)},f={search:e=>s.get(r.knowledge.search,{params:e}),askQuestion:e=>s.post(r.knowledge.qa,e),summarize:e=>s.post(r.knowledge.summarize,e),recommend:e=>s.get(r.knowledge.recommend,{params:e}),getStats:(e={})=>s.get(r.knowledge.stats,e)},A={healthCheck:(e={})=>s.get(r.admin.health,e),getMetrics:()=>s.get(r.admin.metrics),reindex:()=>s.post(r.admin.reindex),getDocuments:(e={},n={})=>s.get(r.admin.documents,{params:e,...n}),uploadDocument:e=>s.post(r.admin.upload,e,{headers:{"Content-Type":"multipart/form-data"}}),deleteDocument:e=>s.delete(r.admin.deleteDocument(e))};export{A as a,f as k};
