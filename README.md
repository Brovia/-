# çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿ

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
4. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
5. [ä¸šåŠ¡æµç¨‹](#ä¸šåŠ¡æµç¨‹)
6. [APIæ¥å£è®¾è®¡](#apiæ¥å£è®¾è®¡)
7. [å‰ç«¯åŠŸèƒ½æ¨¡å—](#å‰ç«¯åŠŸèƒ½æ¨¡å—)
8. [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)
9. [ç›‘æ§ä¸æ—¥å¿—](#ç›‘æ§ä¸æ—¥å¿—)
10. [æ‰©å±•æ€§è®¾è®¡](#æ‰©å±•æ€§è®¾è®¡)

---

## é¡¹ç›®æ¦‚è¿°

### ç³»ç»Ÿç®€ä»‹
ç”¨äºç®¡ç†äº‘æœåŠ¡å•†çš„äº§å“æŠ€æœ¯æ–‡æ¡£ï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒMarkdownã€PDFã€Wordã€Excelã€PowerPointç­‰å¤šç§æ ¼å¼
- **è¯­ä¹‰æœç´¢**: åŸºäºBGEåµŒå…¥æ¨¡å‹çš„è¯­ä¹‰æœç´¢ï¼Œç†è§£æŸ¥è¯¢æ„å›¾
- **æ–‡æ¡£åˆ†ç±»**: æ ¹æ®äº‘æœåŠ¡å•†å’Œäº§å“ç±»å‹åˆ†ç±»ç®¡ç†
- **å‘é‡åŒ–å­˜å‚¨**: ä½¿ç”¨ChromaDBè¿›è¡Œé«˜æ•ˆçš„å‘é‡å­˜å‚¨å’Œæ£€ç´¢
- **å®æ—¶ç´¢å¼•**: æ–‡æ¡£ä¸Šä¼ åè‡ªåŠ¨å»ºç«‹ç´¢å¼•ï¼Œæ”¯æŒå³æ—¶æœç´¢
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå•æ–‡ä»¶ã€å¤šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‰¹é‡ä¸Šä¼ 

---

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **FastAPI**: ç°ä»£åŒ–Python Webæ¡†æ¶ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†å’Œè‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
- **Uvicorn**: ASGIæœåŠ¡å™¨ï¼Œé«˜æ€§èƒ½å¼‚æ­¥HTTPæœåŠ¡å™¨
- **SQLAlchemy**: Python ORMæ¡†æ¶ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“

#### AI/MLæŠ€æœ¯
- **FlagEmbedding**: ä¸­æ–‡ä¼˜åŒ–çš„åµŒå…¥æ¨¡å‹ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢
- **ChromaDB**: å¼€æºå‘é‡æ•°æ®åº“ï¼Œç”¨äºå­˜å‚¨å’Œæ£€ç´¢æ–‡æ¡£å‘é‡
- **LangChain**: AIåº”ç”¨å¼€å‘æ¡†æ¶ï¼Œæä¾›æ–‡æ¡£å¤„ç†èƒ½åŠ›
- **Transformers**: Hugging Faceæ¨¡å‹åº“

#### æ–‡æ¡£å¤„ç†
- **Unstructured**: éç»“æ„åŒ–æ–‡æ¡£è§£æåº“
- **PyPDF**: PDFæ–‡æ¡£å¤„ç†
- **python-docx **: Wordæ–‡æ¡£å¤„ç†
- **openpyxl**: Excelæ–‡æ¡£å¤„ç†
- **python-pptx**: PowerPointæ–‡æ¡£å¤„ç†
- **Markdown**: Markdownæ–‡æ¡£å¤„ç†


### å‰ç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **Vue**: æ¸è¿›å¼JavaScriptæ¡†æ¶ï¼Œä½¿ç”¨Composition API
- **Vite**: ç°ä»£åŒ–æ„å»ºå·¥å…·ï¼Œå¿«é€Ÿå¼€å‘å’Œæ„å»º
- **Vue Router**: å®˜æ–¹è·¯ç”±ç®¡ç†å™¨

#### UIç»„ä»¶åº“
- **Element Plus**: åŸºäºVue 3çš„ç»„ä»¶åº“
- **@element-plus/icons-vue**: Element Pluså›¾æ ‡åº“

#### çŠ¶æ€ç®¡ç†
- **Pinia**: Vue 3å®˜æ–¹æ¨èçš„çŠ¶æ€ç®¡ç†åº“

#### HTTPå®¢æˆ·ç«¯
- **Axios**: Promise-based HTTPå®¢æˆ·ç«¯

#### æ ·å¼å¤„ç†
- **SCSS**: CSSé¢„å¤„ç†å™¨
- **Sass**: SCSSç¼–è¯‘å™¨

#### å…¶ä»–å·¥å…·
- **NProgress**: é¡µé¢åŠ è½½è¿›åº¦æ¡

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±‚ (Frontend)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vue 3 + Element Plus + Pinia + Vue Router                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   ä»ªè¡¨ç›˜     â”‚ â”‚  æ–‡æ¡£ä¸Šä¼     â”‚ â”‚  çŸ¥è¯†æœç´¢     â”‚ â”‚  æ–‡æ¡£ç®¡ç†    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTP/HTTPS
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        APIç½‘å…³å±‚ (Gateway)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FastAPI + Uvicorn + CORS + è®¤è¯ä¸­é—´ä»¶                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  è¯·æ±‚è·¯ç”±    â”‚ â”‚  è®¤è¯æˆæƒ     â”‚ â”‚  å‚æ•°éªŒè¯    â”‚ â”‚  é”™è¯¯å¤„ç†    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ æ–‡æ¡£å¤„ç†æœåŠ¡  â”‚ â”‚ æœç´¢å¼•æ“æœåŠ¡  â”‚ â”‚ å‘é‡å­˜å‚¨æœåŠ¡  â”‚ â”‚ å¥åº·æ£€æŸ¥æœåŠ¡  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ•°æ®å­˜å‚¨å±‚ (Data Storage)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  SQLite     â”‚ â”‚  ChromaDB   â”‚ â”‚  æ–‡ä»¶ç³»ç»Ÿ    â”‚ â”‚   æ—¥å¿—æ–‡ä»¶    â”‚â”‚
â”‚  â”‚  (å…ƒæ•°æ®)    â”‚ â”‚  (å‘é‡å­˜å‚¨)  â”‚ â”‚  (åŸå§‹æ–‡æ¡£)   â”‚ â”‚  (ç³»ç»Ÿæ—¥å¿—)  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—åŒ–æ¶æ„

#### åç«¯æ¨¡å—ç»“æ„

knowledge-base-api/
â”œâ”€â”€ app/                          # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ main.py                   # åº”ç”¨å…¥å£ç‚¹
â”‚   â”œâ”€â”€ api/                      # APIè·¯ç”±å±‚
â”‚   â”‚   â””â”€â”€ v1/                   # APIç‰ˆæœ¬æ§åˆ¶
â”‚   â”‚       â”œâ”€â”€ a2a.py            # a2aç«¯ç‚¹
â”‚   â”‚       â”œâ”€â”€ admin.py          # ç®¡ç†API
â”‚   â”‚       â””â”€â”€ knowledge.py      # çŸ¥è¯†åº“API
â”‚   â”œâ”€â”€ core/                     # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ config.py             # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ database.py           # æ•°æ®åº“é…ç½®
â”‚   â”‚   â””â”€â”€ logging.py            # æ—¥å¿—é…ç½®
â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ document.py           # æ–‡æ¡£æ¨¡å‹
â”‚   â”‚   â””â”€â”€ search.py             # æœç´¢æ¨¡å‹
â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ a2a_service.py        # a2aæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ document_processor.py # æ–‡æ¡£å¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ vector_store.py       # å‘é‡å­˜å‚¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ search_engine.py      # æœç´¢å¼•æ“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ qa_service.py         # é—®ç­”æœåŠ¡
â”‚   â”‚   â””â”€â”€ health_service.py     # å¥åº·æ£€æŸ¥æœåŠ¡
â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”œâ”€â”€ data/                         # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ documents/                # åŸå§‹æ–‡æ¡£å­˜å‚¨
â”‚   â”œâ”€â”€ processed/                # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ vectors/                  # å‘é‡æ•°æ®
â””â”€â”€ scripts/                      # è„šæœ¬å·¥å…·


#### å‰ç«¯æ¨¡å—ç»“æ„

knowledge-base-frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.vue                   # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ main.js                   # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ router/                   # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ stores/                   # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api.js                # APIçŠ¶æ€
â”‚   â”‚   â””â”€â”€ dashboard.js          # ä»ªè¡¨ç›˜çŠ¶æ€
â”‚   â”œâ”€â”€ services/                 # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ api.js                # ç»Ÿä¸€APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ views/                    # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue         # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ Upload.vue            # æ–‡æ¡£ä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ Search.vue            # çŸ¥è¯†æœç´¢
â”‚   â”‚   â”œâ”€â”€ Documents.vue         # æ–‡æ¡£ç®¡ç†
â”‚   â”‚   â””â”€â”€ Settings.vue          # ç³»ç»Ÿè®¾ç½®
â”‚   â”œâ”€â”€ components/               # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ env.js                # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
â””â”€â”€ dist/                         # æ„å»ºè¾“å‡º


---

## æ•°æ®åº“è®¾è®¡

### å…³ç³»å‹æ•°æ®åº“ (SQLite)

#### æ–‡æ¡£è¡¨ (documents)
```sql
CREATE TABLE documents (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title VARCHAR(500) NOT NULL,                    -- æ–‡æ¡£æ ‡é¢˜
    filename VARCHAR(255) NOT NULL UNIQUE,         -- æ–‡ä»¶å
    file_path VARCHAR(1000) NOT NULL,              -- æ–‡ä»¶è·¯å¾„
    content TEXT,                                   -- æ–‡æ¡£å†…å®¹
    content_hash VARCHAR(64),                      -- å†…å®¹å“ˆå¸Œ
    
    -- å…ƒæ•°æ®å­—æ®µ
    source_url VARCHAR(1000),                       -- æºé“¾æ¥
    provider VARCHAR(100),                         -- äº‘æœåŠ¡å•†
    category VARCHAR(100),                         -- äº§å“åˆ†ç±»
    tags JSON,                                     -- æ ‡ç­¾
    doc_metadata JSON,                            -- æ‰©å±•å…ƒæ•°æ®
    
    -- çŠ¶æ€å­—æ®µ
    status VARCHAR(20) DEFAULT 'pending',          -- å¤„ç†çŠ¶æ€
    file_size INTEGER,                            -- æ–‡ä»¶å¤§å°
    word_count INTEGER,                           -- è¯æ•°ç»Ÿè®¡
    
    -- ç´¢å¼•çŠ¶æ€
    vector_indexed BOOLEAN DEFAULT FALSE,          -- å‘é‡ç´¢å¼•çŠ¶æ€
    search_indexed BOOLEAN DEFAULT FALSE,         -- æœç´¢ç´¢å¼•çŠ¶æ€
    
    -- æ—¶é—´æˆ³
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    processed_at DATETIME                          -- å¤„ç†å®Œæˆæ—¶é—´
);

-- ç´¢å¼•
CREATE INDEX idx_documents_provider ON documents(provider);
CREATE INDEX idx_documents_category ON documents(category);
CREATE INDEX idx_documents_status ON documents(status);
CREATE INDEX idx_documents_vector_indexed ON documents(vector_indexed);
CREATE INDEX idx_documents_content_hash ON documents(content_hash);
```

#### æ–‡æ¡£çŠ¶æ€æšä¸¾
```python
class DocumentStatus(str, Enum):
    PENDING = "pending"        # å¾…å¤„ç†
    PROCESSING = "processing" # å¤„ç†ä¸­
    PROCESSED = "processed"   # å·²å¤„ç†
    FAILED = "failed"         # å¤„ç†å¤±è´¥
```

### å‘é‡æ•°æ®åº“ (ChromaDB)

#### é›†åˆç»“æ„
```python
collection_name = "knowledge_base"
collection_metadata = {
    "description": "Knowledge base document chunks",
    "embedding_model": "BAAI/bge-small-zh",
    "embedding_dimension": 512
}
```

#### å‘é‡å­˜å‚¨å­—æ®µ
```python
# æ¯ä¸ªæ–‡æ¡£å—çš„å‘é‡å­˜å‚¨ç»“æ„
{
    "id": "doc_{document_id}_chunk_{chunk_index}",  # å”¯ä¸€æ ‡è¯†
    "embedding": [0.1, 0.2, ...],                   # 512ç»´å‘é‡
    "document": "chunk content",                    # æ–‡æœ¬å†…å®¹
    "metadata": {
        "document_id": 1,                          # æ–‡æ¡£ID
        "chunk_index": 0,                          # å—ç´¢å¼•
        "start_pos": 0,                            # èµ·å§‹ä½ç½®
        "end_pos": 1000,                           # ç»“æŸä½ç½®
        "word_count": 150,                         # è¯æ•°
        "title": "æ–‡æ¡£æ ‡é¢˜",                        # æ–‡æ¡£æ ‡é¢˜
        "provider": "é˜¿é‡Œäº‘",                       # äº‘æœåŠ¡å•†
        "category": "è´Ÿè½½å‡è¡¡",                     # äº§å“åˆ†ç±»
        "source_url": "https://...",               # æºé“¾æ¥
        "filename": "document.md"                  # æ–‡ä»¶å
    }
}
```

### æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨

#### ç›®å½•ç»“æ„
```
data/
â”œâ”€â”€ documents/                    # åŸå§‹æ–‡æ¡£å­˜å‚¨
â”‚   â”œâ”€â”€ é˜¿é‡Œäº‘/
â”‚   â”‚   â”œâ”€â”€ è´Ÿè½½å‡è¡¡/
â”‚   â”‚   â”‚   â”œâ”€â”€ ALB/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ä»€ä¹ˆæ˜¯ALB.md
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ALBé…ç½®.md
â”‚   â”‚   â”‚   â””â”€â”€ CLB/
â”‚   â”‚   â””â”€â”€ ç§æœ‰ç½‘ç»œ/
â”‚   â”œâ”€â”€ è…¾è®¯äº‘/
â”‚   â”‚   â”œâ”€â”€ è´Ÿè½½å‡è¡¡/
â”‚   â”‚   â””â”€â”€ ç§æœ‰ç½‘ç»œ/
â”‚   â””â”€â”€ AWS/
â”œâ”€â”€ processed/                    # å¤„ç†åæ•°æ®ç¼“å­˜
â””â”€â”€ vectors/                      # ChromaDBæ•°æ®æ–‡ä»¶
    â”œâ”€â”€ chroma.sqlite3
    â””â”€â”€ {collection_id}/
        â”œâ”€â”€ data_level0.bin
        â”œâ”€â”€ header.bin
        â””â”€â”€ index_metadata.pickle
```

---

## ä¸šåŠ¡æµç¨‹

### 1. æ–‡æ¡£ä¸Šä¼ æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·é€‰æ‹©æ–‡ä»¶] --> B[æ–‡ä»¶æ ¼å¼éªŒè¯]
    B --> C[è®¾ç½®å…ƒæ•°æ®]
    C --> D[åˆ›å»ºä¸Šä¼ ä»»åŠ¡]
    D --> E[æ–‡ä»¶ä¿å­˜åˆ°ç£ç›˜]
    E --> F[æ–‡æ¡£å†…å®¹è§£æ]
    F --> G[æ–‡æœ¬åˆ†å—å¤„ç†]
    G --> H[ç”Ÿæˆå‘é‡åµŒå…¥]
    H --> I[å­˜å‚¨åˆ°ChromaDB]
    I --> J[æ›´æ–°æ•°æ®åº“è®°å½•]
    J --> K[å»ºç«‹æœç´¢ç´¢å¼•]
    K --> L[è¿”å›ä¸Šä¼ ç»“æœ]
```

#### è¯¦ç»†æ­¥éª¤è¯´æ˜

1. **æ–‡ä»¶æ¥æ”¶**: å‰ç«¯ä¸Šä¼ æ–‡ä»¶åˆ°åç«¯API
2. **æ ¼å¼éªŒè¯**: æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå¤§å°é™åˆ¶
3. **å…ƒæ•°æ®æå–**: ä»æ–‡ä»¶è·¯å¾„å’Œå†…å®¹ä¸­æå–å…ƒæ•°æ®
4. **æ–‡ä»¶å­˜å‚¨**: ä¿å­˜åŸå§‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ç»“æ„
5. **å†…å®¹è§£æ**: ä½¿ç”¨LangChainè§£ææ–‡æ¡£å†…å®¹
6. **æ–‡æœ¬åˆ†å—**: å°†é•¿æ–‡æ¡£åˆ†å‰²æˆæ–‡æœ¬å—
7. **å‘é‡åŒ–**: ä½¿ç”¨BGEæ¨¡å‹ç”Ÿæˆæ–‡æœ¬å—å‘é‡
8. **å‘é‡å­˜å‚¨**: å°†å‘é‡å’Œå…ƒæ•°æ®å­˜å‚¨åˆ°ChromaDB
9. **æ•°æ®åº“æ›´æ–°**: æ›´æ–°SQLiteä¸­çš„æ–‡æ¡£è®°å½•
10. **ç´¢å¼•å»ºç«‹**: å»ºç«‹æœç´¢ç´¢å¼•ï¼Œå¯ä»¥å³æ—¶æœç´¢

### 2. æœç´¢æŸ¥è¯¢æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥æŸ¥è¯¢] --> B[æŸ¥è¯¢é¢„å¤„ç†]
    B --> C[ç”ŸæˆæŸ¥è¯¢å‘é‡]
    C --> D[å‘é‡ç›¸ä¼¼åº¦æœç´¢]
    D --> E[åº”ç”¨è¿‡æ»¤æ¡ä»¶]
    E --> F[ç»“æœæ’åºå’Œåˆ†é¡µ]
    F --> G[è¿”å›æœç´¢ç»“æœ]
    G --> H[å‰ç«¯ç»“æœæ¸²æŸ“]
```

#### è¯¦ç»†æ­¥éª¤è¯´æ˜

1. **æŸ¥è¯¢æ¥æ”¶**: æ¥æ”¶ç”¨æˆ·æœç´¢æŸ¥è¯¢å’Œè¿‡æ»¤æ¡ä»¶
2. **æŸ¥è¯¢é¢„å¤„ç†**: æ¸…ç†å’Œæ ‡å‡†åŒ–æŸ¥è¯¢æ–‡æœ¬
3. **å‘é‡ç”Ÿæˆ**: ä½¿ç”¨BGEæ¨¡å‹ç”ŸæˆæŸ¥è¯¢å‘é‡
4. **ç›¸ä¼¼åº¦æœç´¢**: åœ¨ChromaDBä¸­æ‰§è¡Œå‘é‡ç›¸ä¼¼åº¦æœç´¢
5. **ç»“æœè¿‡æ»¤**: æ ¹æ®æä¾›å•†ã€åˆ†ç±»ç­‰æ¡ä»¶è¿‡æ»¤ç»“æœ
6. **ç›¸ä¼¼åº¦è®¡ç®—**: è®¡ç®—L2è·ç¦»å¹¶è½¬æ¢ä¸ºç›¸ä¼¼åº¦åˆ†æ•°
7. **ç»“æœæ’åº**: æŒ‰ç›¸ä¼¼åº¦åˆ†æ•°é™åºæ’åˆ—
8. **åˆ†é¡µå¤„ç†**: åº”ç”¨åç§»å’Œé™åˆ¶å‚æ•°
9. **ç»“æœè¿”å›**: è¿”å›æ ¼å¼åŒ–çš„æœç´¢ç»“æœ
10. **UIæ¸²æŸ“**: å‰ç«¯æ¸²æŸ“æœç´¢ç»“æœå’Œé«˜äº®æ˜¾ç¤º

### 3. é—®ç­”å¤„ç†æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·æé—®] --> B[é—®é¢˜é¢„å¤„ç†]
    B --> C[ç›¸å…³æ–‡æ¡£æ£€ç´¢]
    C --> D[ä¸Šä¸‹æ–‡æ„å»º]
    D --> E[LLMç”Ÿæˆå›ç­”]
    E --> F[ç­”æ¡ˆåå¤„ç†]
    F --> G[è¿”å›é—®ç­”ç»“æœ]
```

#### è¯¦ç»†æ­¥éª¤è¯´æ˜

1. **é—®é¢˜æ¥æ”¶**: æ¥æ”¶ç”¨æˆ·é—®é¢˜å’Œç›¸å…³å‚æ•°
2. **é—®é¢˜åˆ†æ**: åˆ†æé—®é¢˜ç±»å‹å’Œæ„å›¾
3. **æ–‡æ¡£æ£€ç´¢**: ä½¿ç”¨è¯­ä¹‰æœç´¢æ‰¾åˆ°ç›¸å…³æ–‡æ¡£
4. **ä¸Šä¸‹æ–‡æ„å»º**: æ„å»ºåŒ…å«ç›¸å…³æ–‡æ¡£çš„ä¸Šä¸‹æ–‡
5. **ç­”æ¡ˆç”Ÿæˆ**: è°ƒç”¨LLMç”Ÿæˆå›ç­”
6. **ç­”æ¡ˆéªŒè¯**: éªŒè¯ç­”æ¡ˆè´¨é‡å’Œç›¸å…³æ€§
7. **æ¥æºæ ‡æ³¨**: æ ‡æ³¨ç­”æ¡ˆæ¥æºæ–‡æ¡£
8. **ç»“æœè¿”å›**: è¿”å›æ ¼å¼åŒ–çš„é—®ç­”ç»“æœ

---

## APIæ¥å£è®¾è®¡

### RESTful APIè§„èŒƒ

#### åŸºç¡€URL
```
ç”Ÿäº§ç¯å¢ƒ: https://api.example.com/api/v1
å¼€å‘ç¯å¢ƒ: http://localhost:8000/api/v1
```

### çŸ¥è¯†åº“API

#### 1. æœç´¢æ¥å£
```http
GET /api/v1/knowledge/search
```

**è¯·æ±‚å‚æ•°:**
```json
{
  "query": "è´Ÿè½½å‡è¡¡é…ç½®",
  "limit": 10,
  "offset": 0,
  "provider": "é˜¿é‡Œäº‘",
  "category": "è´Ÿè½½å‡è¡¡",
  "min_score": 0.5
}
```

**å“åº”æ ¼å¼:**
```json
{
  "total": 25,
  "results": [
    {
      "id": 1,
      "title": "é˜¿é‡Œäº‘ALBé…ç½®æŒ‡å—",
      "content": "Application Load Balancer (ALB) æ˜¯é˜¿é‡Œäº‘...",
      "source": "é˜¿é‡Œäº‘/è´Ÿè½½å‡è¡¡/ALB/é…ç½®æŒ‡å—.md",
      "score": 0.95,
      "metadata": {
        "provider": "é˜¿é‡Œäº‘",
        "category": "è´Ÿè½½å‡è¡¡",
        "source_url": "https://help.aliyun.com/..."
      }
    }
  ],
  "query": "è´Ÿè½½å‡è¡¡é…ç½®",
  "search_type": "semantic",
  "processing_time": 0.156
}
```

#### 2. æ–‡æœ¬æ‘˜è¦æ¥å£
```http
POST /api/v1/knowledge/summarize
```

**è¯·æ±‚ä½“:**
```json
{
  "document_id": 1,
  "summary_type": "brief",
  "max_length": 200
}
```

#### 3. ç»Ÿè®¡ä¿¡æ¯æ¥å£
```http
GET /api/v1/knowledge/stats
```

**å“åº”æ ¼å¼:**
```json
{
  "vector_store": {
    "total_chunks": 1250,
    "total_documents": 156,
    "providers": ["é˜¿é‡Œäº‘", "è…¾è®¯äº‘", "AWS"],
    "categories": ["è´Ÿè½½å‡è¡¡", "ç§æœ‰ç½‘ç»œ"],
    "provider_distribution": {
      "é˜¿é‡Œäº‘": {"count": 500, "percentage": 40.0},
      "è…¾è®¯äº‘": {"count": 400, "percentage": 32.0}
    }
  },
  "last_updated": 1703123456.789
}
```

### ç®¡ç†API

#### 1. æ–‡æ¡£ä¸Šä¼ æ¥å£
```http
POST /api/v1/admin/documents/upload
Content-Type: multipart/form-data
```

**è¯·æ±‚ä½“:**
```
file: <binary_file_data>
provider: é˜¿é‡Œäº‘
category: è´Ÿè½½å‡è¡¡
title: æ–‡æ¡£æ ‡é¢˜
relative_path: subfolder/document.md
```

**å“åº”æ ¼å¼:**
```json
{
  "message": "Document uploaded successfully",
  "filename": "document.md",
  "document_id": "123",
  "title": "æ–‡æ¡£æ ‡é¢˜",
  "provider": "é˜¿é‡Œäº‘",
  "category": "è´Ÿè½½å‡è¡¡",
  "size": "1024",
  "word_count": "150"
}
```

#### 2. æ–‡æ¡£åˆ—è¡¨æ¥å£
```http
GET /api/v1/admin/documents
```

**è¯·æ±‚å‚æ•°:**
```json
{
  "skip": 0,
  "limit": 20,
  "provider": "é˜¿é‡Œäº‘",
  "category": "è´Ÿè½½å‡è¡¡",
  "doc_status": "processed"
}
```

#### 3. æ–‡æ¡£åˆ é™¤æ¥å£
```http
DELETE /api/v1/admin/documents/{document_id}
```

#### 4. é‡å»ºç´¢å¼•æ¥å£
```http
POST /api/v1/admin/reindex
```

#### 5. å¥åº·æ£€æŸ¥æ¥å£
```http
GET /api/v1/admin/health
```

**å“åº”æ ¼å¼:**
```json
{
  "status": "healthy",
  "timestamp": 1703123456.789,
  "version": "1.0.0",
  "components": {
    "database": {
      "status": "healthy",
      "response_time": 0.001
    },
    "vector_store": {
      "status": "healthy",
      "collection_count": 1,
      "total_chunks": 1250
    },
    "embedding_model": {
      "status": "healthy",
      "model_name": "BAAI/bge-small-zh",
      "dimension": 512
    }
  }
}
```

#### 6. ç³»ç»ŸæŒ‡æ ‡æ¥å£
```http
GET /api/v1/admin/metrics
```

---

## å‰ç«¯åŠŸèƒ½æ¨¡å—

### 1. ä»ªè¡¨ç›˜æ¨¡å— (Dashboard)

#### åŠŸèƒ½ç‰¹æ€§
- **ç³»ç»Ÿæ¦‚è§ˆ**: æ˜¾ç¤ºæ–‡æ¡£æ€»æ•°ã€æ–‡æœ¬å—æ•°ã€äº‘æœåŠ¡å•†æ•°é‡
- **æ•°æ®ç»Ÿè®¡**: å®æ—¶å±•ç¤ºçŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯
- **äº‘æœåŠ¡å•†åˆ†å¸ƒ**: å¯è§†åŒ–å±•ç¤ºå„äº‘æœåŠ¡å•†çš„æ–‡æ¡£åˆ†å¸ƒ
- **å¿«é€Ÿæ“ä½œ**: æä¾›å¸¸ç”¨åŠŸèƒ½çš„å¿«æ·å…¥å£

#### æŠ€æœ¯å®ç°
```vue
<template>
  <div class="dashboard-page">
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <el-row :gutter="24" class="stats-row">
      <el-col :span="8">
        <div class="stat-card">
          <div class="stat-icon">
            <el-icon><Document /></el-icon>
          </div>
          <div class="stat-content">
            <div class="stat-label">æ–‡æ¡£æ€»æ•°</div>
            <div class="stat-number">{{ stats.total_documents }}</div>
          </div>
        </div>
      </el-col>
    </el-row>
    
    <!-- äº‘æœåŠ¡å•†åˆ†å¸ƒ -->
    <div class="providers-card">
      <div v-for="provider in stats.providers" :key="provider">
        <el-progress 
          :percentage="getProviderPercentage(provider)"
          :color="getProviderColor(provider)"
        />
      </div>
    </div>
  </div>
</template>
```

#### çŠ¶æ€ç®¡ç†
```javascript
// stores/dashboard.js
export const useDashboardStore = defineStore('dashboard', {
  state: () => ({
    stats: {},
    isLoading: false,
    hasError: false,
    errorMessage: '',
    lastUpdated: null
  }),
  
  actions: {
    async fetchStats(forceRefresh = false) {
      // è·å–ç»Ÿè®¡æ•°æ®çš„é€»è¾‘
    },
    
    getProviderPercentage(provider) {
      // è®¡ç®—æä¾›å•†ç™¾åˆ†æ¯”
    }
  }
})
```

### 2. æ–‡æ¡£ä¸Šä¼ æ¨¡å— (Upload)

#### åŠŸèƒ½ç‰¹æ€§
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ.md, .doc, .docx, .pdf, .txt, .xlsx, .xls, .pptx, .ppt
- **æ‰¹é‡ä¸Šä¼ **: æ”¯æŒå•æ–‡ä»¶ã€å¤šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‰¹é‡ä¸Šä¼ 
- **å…ƒæ•°æ®è®¾ç½®**: æ”¯æŒè®¾ç½®äº‘æœåŠ¡å•†ã€äº§å“åˆ†ç±»ç­‰å…ƒæ•°æ®
- **ä¸Šä¼ é˜Ÿåˆ—**: æ”¯æŒå¤šä¸ªä¸Šä¼ ä»»åŠ¡å¹¶è¡Œå¤„ç†
- **è¿›åº¦è·Ÿè¸ª**: å®æ—¶æ˜¾ç¤ºä¸Šä¼ è¿›åº¦å’Œç»“æœ

#### æŠ€æœ¯å®ç°
```vue
<template>
  <div class="upload-page">
    <!-- å…ƒæ•°æ®è®¾ç½® -->
    <div class="metadata-section">
      <el-form-item label="äº‘æœåŠ¡å•†" required>
        <el-select v-model="documentMetadata.provider">
          <el-option label="é˜¿é‡Œäº‘" value="é˜¿é‡Œäº‘" />
          <el-option label="è…¾è®¯äº‘" value="è…¾è®¯äº‘" />
        </el-select>
      </el-form-item>
    </div>
    
    <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
    <el-upload
      ref="uploadRef"
      drag
      :action="uploadUrl"
      :data="uploadData"
      :before-upload="beforeUpload"
      :on-success="onUploadSuccess"
      multiple
    >
      <el-icon><upload-filled /></el-icon>
      <div>å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»ä¸Šä¼ </div>
    </el-upload>
    
    <!-- ä¸Šä¼ ä»»åŠ¡åˆ—è¡¨ -->
    <div class="upload-tasks">
      <div v-for="task in uploadTasks" :key="task.id">
        <el-progress :percentage="task.progress" />
      </div>
    </div>
  </div>
</template>
```

#### ä¸Šä¼ æµç¨‹
1. **æ–‡ä»¶é€‰æ‹©**: ç”¨æˆ·é€‰æ‹©æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹
2. **æ ¼å¼éªŒè¯**: æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå¤§å°
3. **å…ƒæ•°æ®è®¾ç½®**: è®¾ç½®äº‘æœåŠ¡å•†å’Œåˆ†ç±»
4. **åˆ›å»ºä»»åŠ¡**: åˆ›å»ºä¸Šä¼ ä»»åŠ¡å¹¶åŠ å…¥é˜Ÿåˆ—
5. **å¹¶è¡Œä¸Šä¼ **: å¤šä¸ªæ–‡ä»¶å¹¶è¡Œä¸Šä¼ å¤„ç†
6. **è¿›åº¦è·Ÿè¸ª**: å®æ—¶æ›´æ–°ä¸Šä¼ è¿›åº¦
7. **ç»“æœå¤„ç†**: æ˜¾ç¤ºä¸Šä¼ ç»“æœå’Œé”™è¯¯ä¿¡æ¯

### 3. çŸ¥è¯†æœç´¢æ¨¡å— (Search)

#### åŠŸèƒ½ç‰¹æ€§
- **è¯­ä¹‰æœç´¢**: åŸºäºBGEæ¨¡å‹çš„æ™ºèƒ½è¯­ä¹‰æœç´¢
- **é«˜çº§è¿‡æ»¤**: æ”¯æŒæŒ‰äº‘æœåŠ¡å•†ã€äº§å“åˆ†ç±»è¿‡æ»¤
- **ç›¸ä¼¼åº¦æ§åˆ¶**: å¯è°ƒèŠ‚æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼
- **ç»“æœé«˜äº®**: æœç´¢ç»“æœå…³é”®è¯é«˜äº®æ˜¾ç¤º
- **åˆ†é¡µæ”¯æŒ**: æ”¯æŒå¤§é‡ç»“æœçš„åˆ†é¡µæµè§ˆ

#### æŠ€æœ¯å®ç°
```vue
<template>
  <div class="search-page">
    <!-- æœç´¢è¡¨å• -->
    <el-form :model="searchForm" @submit.prevent="handleSearch">
      <el-input
        v-model="searchForm.query"
        placeholder="è¯·è¾“å…¥æœç´¢å…³é”®è¯..."
        @keyup.enter="handleSearch"
      />
      
      <el-select v-model="searchForm.provider" placeholder="é€‰æ‹©äº‘æœåŠ¡å•†">
        <el-option label="é˜¿é‡Œäº‘" value="é˜¿é‡Œäº‘" />
        <el-option label="è…¾è®¯äº‘" value="è…¾è®¯äº‘" />
      </el-select>
      
      <el-button type="primary" @click="handleSearch">æœç´¢</el-button>
    </el-form>
    
    <!-- æœç´¢ç»“æœ -->
    <div v-for="result in searchResults" :key="result.id">
      <div class="result-title">{{ result.title }}</div>
      <div class="result-content">{{ result.content }}</div>
      <div class="result-meta">
        <el-tag>{{ result.metadata.provider }}</el-tag>
        <span class="result-score">ç›¸ä¼¼åº¦: {{ (result.score * 100).toFixed(1) }}%</span>
      </div>
    </div>
  </div>
</template>
```

#### æœç´¢æµç¨‹
1. **æŸ¥è¯¢æ„å»º**: æ„å»ºæœç´¢å‚æ•°å’Œè¿‡æ»¤æ¡ä»¶
2. **APIè°ƒç”¨**: è°ƒç”¨åç«¯æœç´¢æ¥å£
3. **ç»“æœå¤„ç†**: å¤„ç†æœç´¢ç»“æœå’Œå…ƒæ•°æ®
4. **UIæ¸²æŸ“**: æ¸²æŸ“æœç´¢ç»“æœå’Œé«˜äº®æ˜¾ç¤º
5. **äº¤äº’åé¦ˆ**: æä¾›ç”¨æˆ·äº¤äº’å’Œæ“ä½œåé¦ˆ

### 4. æ–‡æ¡£ç®¡ç†æ¨¡å— (Documents)

#### åŠŸèƒ½ç‰¹æ€§
- **æ–‡æ¡£åˆ—è¡¨**: å±•ç¤ºæ‰€æœ‰å·²ä¸Šä¼ çš„æ–‡æ¡£
- **åˆ†ç±»ç­›é€‰**: æŒ‰äº‘æœåŠ¡å•†ã€åˆ†ç±»ã€çŠ¶æ€ç­›é€‰
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ é™¤ã€é‡æ–°ç´¢å¼•ç­‰æ“ä½œ
- **è¯¦æƒ…æŸ¥çœ‹**: æŸ¥çœ‹æ–‡æ¡£è¯¦ç»†ä¿¡æ¯å’Œå†…å®¹
- **çŠ¶æ€ç®¡ç†**: æ˜¾ç¤ºæ–‡æ¡£å¤„ç†çŠ¶æ€å’Œç´¢å¼•çŠ¶æ€

### 5. ç³»ç»Ÿè®¾ç½®æ¨¡å— (Settings)

#### åŠŸèƒ½ç‰¹æ€§
- **APIé…ç½®**: é…ç½®APIå¯†é’¥å’Œè¿æ¥å‚æ•°
- **ç³»ç»Ÿå‚æ•°**: è°ƒæ•´ç³»ç»Ÿè¿è¡Œå‚æ•°
- **æ•°æ®ç®¡ç†**: æ•°æ®å¤‡ä»½ã€æ¸…ç†ã€é‡å»ºç´¢å¼•
- **ç³»ç»Ÿç›‘æ§**: æŸ¥çœ‹ç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡

---

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### åç«¯éƒ¨ç½²
```bash
# 1. ç¯å¢ƒå‡†å¤‡
cd knowledge-base-api

# 2. ä¾èµ–å®‰è£…
pip install -r requirements.txt

# 3. æ•°æ®åº“åˆå§‹åŒ–
python scripts/init_db.py

# 4. å¯åŠ¨æœåŠ¡
python run_dev.py
# æˆ–
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### å‰ç«¯éƒ¨ç½²
```bash
# 1. ç¯å¢ƒå‡†å¤‡
cd knowledge-base-frontend
npm install

# 2. å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

---

## ç›‘æ§ä¸æ—¥å¿—

### 1. æ—¥å¿—ç³»ç»Ÿ

#### ç»“æ„åŒ–æ—¥å¿—
```python
import logging
import json
from datetime import datetime

class StructuredLogger:
    def __init__(self, name: str):
        self.logger = logging.getLogger(name)
        self.logger.setLevel(logging.INFO)
        
        # JSONæ ¼å¼å¤„ç†å™¨
        json_handler = logging.FileHandler('logs/app.log')
        json_formatter = logging.Formatter(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        )
        json_handler.setFormatter(json_formatter)
        self.logger.addHandler(json_handler)
    
    def log_request(self, request_id: str, method: str, url: str, 
                   status_code: int, duration: float):
        log_data = {
            "timestamp": datetime.utcnow().isoformat(),
            "type": "request",
            "request_id": request_id,
            "method": method,
            "url": str(url),
            "status_code": status_code,
            "duration": duration
        }
        self.logger.info(json.dumps(log_data))
    
    def log_error(self, error: Exception, context: str = ""):
        log_data = {
            "timestamp": datetime.utcnow().isoformat(),
            "type": "error",
            "error_type": type(error).__name__,
            "error_message": str(error),
            "context": context
        }
        self.logger.error(json.dumps(log_data))
```

#### æ€§èƒ½ç›‘æ§
```python
import time
from functools import wraps

def monitor_performance(func):
    @wraps(func)
    async def wrapper(*args, **kwargs):
        start_time = time.time()
        try:
            result = await func(*args, **kwargs)
            duration = time.time() - start_time
            
            # è®°å½•æ€§èƒ½æ—¥å¿—
            logger.log_performance(
                function_name=func.__name__,
                duration=duration,
                status="success"
            )
            return result
        except Exception as e:
            duration = time.time() - start_time
            logger.log_performance(
                function_name=func.__name__,
                duration=duration,
                status="error",
                error=str(e)
            )
            raise
    return wrapper
```

### 2. å¥åº·æ£€æŸ¥

#### ç³»ç»Ÿå¥åº·ç›‘æ§
```python
class HealthService:
    def __init__(self, vector_store: VectorStore):
        self.vector_store = vector_store
    
    def get_health_status(self) -> dict:
        health_status = {
            "status": "healthy",
            "timestamp": time.time(),
            "version": settings.APP_VERSION,
            "components": {}
        }
        
        # æ•°æ®åº“å¥åº·æ£€æŸ¥
        db_status = self._check_database()
        health_status["components"]["database"] = db_status
        
        # å‘é‡å­˜å‚¨å¥åº·æ£€æŸ¥
        vector_status = self._check_vector_store()
        health_status["components"]["vector_store"] = vector_status
        
        # åµŒå…¥æ¨¡å‹å¥åº·æ£€æŸ¥
        model_status = self._check_embedding_model()
        health_status["components"]["embedding_model"] = model_status
        
        # æ•´ä½“çŠ¶æ€åˆ¤æ–­
        if any(comp["status"] != "healthy" for comp in health_status["components"].values()):
            health_status["status"] = "unhealthy"
        
        return health_status
    
    def _check_database(self) -> dict:
        try:
            start_time = time.time()
            db = next(get_db())
            db.execute("SELECT 1")
            response_time = time.time() - start_time
            
            return {
                "status": "healthy",
                "response_time": round(response_time, 3)
            }
        except Exception as e:
            return {
                "status": "unhealthy",
                "error": str(e)
            }
```

### 3. æŒ‡æ ‡æ”¶é›†

#### ä¸šåŠ¡æŒ‡æ ‡
```python
class MetricsCollector:
    def __init__(self):
        self.metrics = {
            "requests_total": 0,
            "requests_duration": [],
            "search_queries": 0,
            "documents_uploaded": 0,
            "errors_total": 0
        }
    
    def increment_counter(self, metric_name: str, value: int = 1):
        if metric_name in self.metrics:
            self.metrics[metric_name] += value
    
    def record_duration(self, duration: float):
        self.metrics["requests_duration"].append(duration)
        # ä¿æŒæœ€è¿‘1000ä¸ªè®°å½•
        if len(self.metrics["requests_duration"]) > 1000:
            self.metrics["requests_duration"] = self.metrics["requests_duration"][-1000:]
    
    def get_metrics_summary(self) -> dict:
        durations = self.metrics["requests_duration"]
        return {
            "total_requests": self.metrics["requests_total"],
            "avg_duration": sum(durations) / len(durations) if durations else 0,
            "max_duration": max(durations) if durations else 0,
            "search_queries": self.metrics["search_queries"],
            "documents_uploaded": self.metrics["documents_uploaded"],
            "error_rate": self.metrics["errors_total"] / max(self.metrics["requests_total"], 1)
        }
```

---

## æ‰©å±•æ€§è®¾è®¡

### 1. æ°´å¹³æ‰©å±•

#### è´Ÿè½½å‡è¡¡
```nginx
upstream backend_servers {
    server backend1:8000 weight=3;
    server backend2:8000 weight=3;
    server backend3:8000 weight=2;
    server backend4:8000 weight=2;
}

server {
    location /api/ {
        proxy_pass http://backend_servers;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 2. æ•°æ®åº“æ‰©å±•

#### è¯»å†™åˆ†ç¦»
```python
class DatabaseManager:
    def __init__(self):
        self.write_engine = create_engine(settings.WRITE_DATABASE_URL)
        self.read_engine = create_engine(settings.READ_DATABASE_URL)
    
    def get_write_session(self):
        return sessionmaker(bind=self.write_engine)()
    
    def get_read_session(self):
        return sessionmaker(bind=self.read_engine)()
```

#### åˆ†åº“åˆ†è¡¨
```python
class ShardedDocumentManager:
    def __init__(self):
        self.shards = {
            'shard_1': create_engine('sqlite:///shard_1.db'),
            'shard_2': create_engine('sqlite:///shard_2.db'),
            'shard_3': create_engine('sqlite:///shard_3.db')
        }
    
    def get_shard(self, document_id: int):
        shard_key = document_id % len(self.shards)
        return self.shards[f'shard_{shard_key + 1}']
```

### 3. ç¼“å­˜æ‰©å±•

#### å¤šçº§ç¼“å­˜
```python
class CacheManager:
    def __init__(self):
        self.l1_cache = {}  # å†…å­˜ç¼“å­˜
        self.l2_cache = redis.Redis()  # Redisç¼“å­˜
        self.l3_cache = None  # åˆ†å¸ƒå¼ç¼“å­˜
    
    async def get(self, key: str):
        # L1ç¼“å­˜
        if key in self.l1_cache:
            return self.l1_cache[key]
        
        # L2ç¼“å­˜
        value = self.l2_cache.get(key)
        if value:
            self.l1_cache[key] = value
            return value
        
        return None
    
    async def set(self, key: str, value: str, ttl: int = 300):
        self.l1_cache[key] = value
        self.l2_cache.setex(key, ttl, value)
```

### 4. æ’ä»¶ç³»ç»Ÿ

#### æ’ä»¶æ¥å£
```python
from abc import ABC, abstractmethod

class DocumentProcessorPlugin(ABC):
    @abstractmethod
    def can_process(self, file_path: str) -> bool:
        pass
    
    @abstractmethod
    def process(self, file_path: str) -> dict:
        pass

class PluginManager:
    def __init__(self):
        self.plugins = []
    
    def register_plugin(self, plugin: DocumentProcessorPlugin):
        self.plugins.append(plugin)
    
    def process_document(self, file_path: str):
        for plugin in self.plugins:
            if plugin.can_process(file_path):
                return plugin.process(file_path)
        return None
```

---